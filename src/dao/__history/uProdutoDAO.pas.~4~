unit uProdutoDAO;

interface

uses
  System.SysUtils, FireDAC.Comp.Client,
  uProdutoModel, uConexao;

type
  TProdutoDAO = class
  public
    function Buscar(Codigo: Integer): TProdutoModel;
  end;

implementation

{ TProdutoDAO }

function TProdutoDAO.Buscar(Codigo: Integer): TProdutoModel;
var
  Q: TFDQuery;
begin
  Result := nil;
  Q := TFDQuery.Create(nil);
  try
    Q.Connection := TConexao.GetConnection;
    Q.SQL.Text := 'SELECT * FROM produtos WHERE codigo = :p';
    Q.ParamByName('p').AsInteger := Codigo;
    Q.Open;

    if not Q.IsEmpty then
    begin
      Result := TProduto.Create;
      Result.Codigo      := Q.FieldByName('codigo').AsInteger;
      Result.Descricao   := Q.FieldByName('descricao').AsString;
      Result.PrecoVenda  := Q.FieldByName('preco_venda').AsFloat;
    end;
  finally
    Q.Free;
  end;
end;

end.

